function delay_1abr(k,p,q)

% One-delay z - a - b*e^(-r*z)
% p = x_max, q = y_max

h=p/100;
w=q/50;
x(1) = 0;
y(1) = q;
u1(1) = 3.0*x(1)*y(1)^2-0.182131947240132*exp(-k*x(1))*(cos(-y(1)*k))-0.65*x(1)-1.6*x(1)^2-1.0*x(1)^3+1.6*y(1)^2- 0.05;
w1(1) = -y(1)*0.65-x(1)*y(1)*3.2-0.182131947240132*exp(-k*x(1))*sin(-y(1)*k)-x(1)^2*y(1)*3.0+y(1)^3*1.0;
for i=2:101
    x(i) = 0;
    y(i) = y(i-1)-w;
    u1(i) = 3.0*x(1)*y(1)^2-0.182131947240132*exp(-k*x(1))*(cos(-y(1)*k))-0.65*x(1)-1.6*x(1)^2-1.0*x(1)^3+1.6*y(1)^2- 0.05;
    w1(i) = -y(1)*0.65-x(1)*y(1)*3.2-0.182131947240132*exp(-k*x(1))...
       *sin(-y(1)*k)-x(1)^2*y(1)*3.0+y(1)^3*1.0;
end
for i=102:201
    x(i) = x(i-1)+h;
    y(i) = -q;
    u2(i-101) = 3.0*x(1)*y(1)^2-0.182131947240132*exp(-k*x(1))*(cos(-y(1)*k))-0.65*x(1)-1.6*x(1)^2-1.0*x(1)^3+1.6*y(1)^2- 0.05;
    w2(i-101) = -y(1)*0.65-x(1)*y(1)*3.2-0.182131947240132*exp(-k*x(1))*sin(-y(1)*k)-x(1)^2*y(1)*3.0+y(1)^3*1.0;
end
for i=202:301
    x(i) = p;
    y(i) = y(i-1)+w;
    u3(i-201) = 3.0*x(1)*y(1)^2-0.182131947240132*exp(-k*x(1))*(cos(-y(1)*k))-0.65*x(1)-1.6*x(1)^2-1.0*x(1)^3+1.6*y(1)^2- 0.05;
    w3(i-201) = -y(1)*0.65-x(1)*y(1)*3.2-0.182131947240132*exp(-k*x(1))*sin(-y(1)*k)-x(1)^2*y(1)*3.0+y(1)^3*1.0;
end
for i=302:401
    x(i) = x(i-1)-h;
    y(i) = q;
    u4(i-301) = 3.0*x(1)*y(1)^2-0.182131947240132*exp(-k*x(1))*(cos(-y(1)*k))-0.65*x(1)-1.6*x(1)^2-1.0*x(1)^3+1.6*y(1)^2- 0.05;
    w4(i-301) = -y(1)*0.65-x(1)*y(1)*3.2-0.182131947240132*exp(-k*x(1))*sin(-y(1)*k)-x(1)^2*y(1)*3.0+y(1)^3*1.0;
end
plot(u1,w1,'b-',u2,w2,'r-',u3,w3,'g-',u4,w4,'m-');grid

% delay_1abr(-0.5,-2,1,3,4)

